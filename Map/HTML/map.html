<!DOCTYPE html>
<html>
<head>
<meta charset=utf-8 />
<title>A simple map</title>
<link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.css" />
<script src="http://cdn.leafletjs.com/leaflet/v1.0.0-rc.1/leaflet.js"></script>
<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyC95qiflxZ2XVSOypJpjAmZttSWZHEFx0A&language=fr"
type="text/javascript">
</script>
<script src="../JS/jquery.min.js" charset="utf-8"></script>
<style>
  body { margin:0; padding:0; }
  #map { position:absolute; top:30px; bottom:0; width:100%;}
  #choix { position:absolute; top:5px; bottom:0; left:30px; height:30px;}
</style>
</head>
<body>
<div id='map'> </div>
<div id='choix'> 
Donnez une adresse :
<input type = "text"
       id = "adresse" 
       onkeydown = "if (event.keyCode == 13)
                        document.getElementById('btnSearch').click()"/>

<input type = "button"
       id = "btnSearch"
       value = "Valider"
       onclick = "searchAdress();"/>
   Placer un marqueur :
<input type="checkbox" id="marker">

   Placer une zone :
<input type="checkbox" id="aire">
</div>
<script>

var marker=1;
var valeur=0;
  
//L.mapbox.accessToken = 'pk.eyJ1IjoiYXVkZWxhZGVzbWVyczY3IiwiYSI6ImNpb2FoMmV0NjAza3d2NGtxbjZ3MzQ3eXIifQ.hPhQrDZDF-SbfyMD9Wzy4w';

var map = L.map('map')
    .setView([45.504629, -73.55686], 11);
	
L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
    attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
}).addTo(map);
	
 map.on('click', function(e) {
	if (document.getElementById('marker').checked==true)
	alert(e.latlng)
    placeMarkerAndPanTo(e.latlng.lat,e.latlng.lng , map);
	if (document.getElementById('aire').checked==true)
    placeAire(e, map);
  });
  
 function placeMarkerAndPanTo(lat , lng, map) {
 if (marker==1) {
 marker = L.marker([lat, lng]).addTo(map);
map.panTo(L.latLng(lat,lng));
}
else {
    marker.setLatLng(L.latLng(lat,lng));
	map.panTo(L.latLng(lat,lng));
		}
};

var searchAdress = function(){
	var adresse = document.getElementById('adresse').value;
	var xml = httpGet('https://maps.googleapis.com/maps/api/geocode/json?address='+adresse+'&key=AIzaSyC95qiflxZ2XVSOypJpjAmZttSWZHEFx0A');
	var endroit = xml.indexOf('"location"');
	var temp = xml.indexOf(':',endroit+13)+1;
	var temp2 = xml.indexOf(',',endroit);
	var lat = xml.substring(temp,temp2);
	var lng = xml.substring(xml.indexOf(':',temp2)+1,xml.indexOf('}',temp2+1));
	placeMarkerAndPanTo(lat, lng, map)
}

function httpGet(theUrl)
{
    var xmlHttp = new XMLHttpRequest();
    xmlHttp.open( "GET", theUrl, false ); // false for synchronous request
    xmlHttp.send( null );
    return xmlHttp.responseText;
}
</script>
</body>
</html>